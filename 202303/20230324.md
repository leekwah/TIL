###### join()

- 쓰레드 자신이 하던 작업을 잠시 멈추고 다를 쓰레드가 지정된 시간동안 작업을 수행하도록 할 때 join() 메서드를 사용한다.

```java
void join() // 작업이 모두 끝날 때 까지
void join(long millis) // 천분의 일초 동안
void join(long millis, int nanos) // 천분의 일초 + 나노초 동안
```

- 시간을 지정하지 않으면, 해당 쓰레드가 작업을 모두 마칠 때까지 기다리게 된다.
- 작업 중에 다른 쓰레드의 작업이 먼저 수행되야 할 필요가 있을 때 join() 메서드를 사용한다.

```java
try {
  th.join(); // 현재 실행중인 쓰레드가 쓰레드 th의 작업이 끝날 때 까지 기다린다.
} catch(InterruptedException e) {}
```

- join() 메서드도 sleep() 메서드처럼 interrupt() 메서드에 의해 대기상태에서 벗어날 수 있으며, join() 메서드가 호출되는 부분을 try-catch문으로 감싸야 한다.
-  join() 메서드는 sleep() 메서드와는 다르게 현재 쓰레드가 아닌 특정 쓰레드에 대해 동작하므로 static 메서드가 아니다.

##### yield()

- yield() 메서드는 쓰레드 자신(현재 쓰레드)에게 주어진 실행시간을 다음 차례의 쓰레드에게 양보(yield)한다.
- 1초의 실행시간을 할당받은 쓰레드가 0.5초의 시간동안 작업한 상태에서 yield() 메서드가 호출되면, 나머지 0.5초는 포기하고 다시 실행상태가 된다.
- yield() 메서드와 interrupt() 메서드를 적절히 사용하면, 프로그램의 응답성을 높이고, 보다 효율적인 실행이 가능하게 할 수 있다.

##### 쓰레드의 동기화(synchronization)

- 쓰레드의 동기화(synchronization)는 한 쓰레드가 진행 중인 작업을 다른 쓰레드가 간섭하지 못하도록 막는 것이다.
- 멀티쓰레드 프로세스의 경우 여러 쓰레드가 같은 프로세스 내의 자원을 공유해서 작업하기 때문에 서로의 작업에 영향을 주게 되어 원래 의도했던 것과는 다른 결과를 얻을 수 있다.
- 이러한 일이 발생하는 것을 방지하기 위해서 한 쓰레드가 특정 작업을 끝내기 전까지 다른 쓰레드에 의해 방해받지 않도록 하기 위해서 도입된 개념이 '임계 영역(critical section)'과 '잠금(lock)'이다.
- 공유 데이터를 사용하는 코드 영역을 임계영역으로 지정해놓고, 공유 데이터(객체)가 가지고 있는 lock을 획득한 단 하나의 쓰레드만 이 영역 내의 코드를 수행할 수 있게 한다.
- 그리고 해당 쓰레드가 임계영역 내의 모든 코드를 수행하고 벗어나서 lock을 반납해야만 다른 쓰레드가 반납된 lock을 획득하여 임계 영역의 코드를 수행할 수 있게 된다.
- 즉 쓰레드의 동기화는 한 쓰레드가 진행중인 작업을 다른 쓰레드가 간섭하지 못하게 막는 것이다.
- 자바에서는 synchronized 블럭을 이용해서 쓰레드의 동기화를 지원했지만, JDKl.5부터는 'java.util.concurrent.locks'와 'java.util.concurrent.atomic' 패키지를 통해서 다양한 방식으로 동기화를 구현할 수 있도록 지원하고 있다.

##### synchronized를 이용한 동기화

1. 메서드 전체를 임계 영역으로 지정
   - synchronized를 붙이면 메서드 전체가 임계 영역으로 설정된다.
   - 쓰레드는 synchronized 메서드가 호출된 시점부터 해당 메서드가 포함된 객체의 lock을 얻어 작업을 수행하다가 메서드가 종료되면 lock을 반환한다.

```java
public synchronized void calcSum() { // 임계 영역(critical section)
  // ...
}
```

2. 특정한 영역을 임계 영역으로 지정
   - 메서드 내의 코드 일부를 블럭{} 으로 감싸고 블럭 앞에 'synchronized(참조변수)'를 붙이는 건데, 이 때 참조변수는 lock을 걸고자하는 객체를 참조하는 것이어야 한다.
   - 이 블럭을 synchroznied 블럭이라고 하며, 이 블럭의 영역 안으로 들어가면서붜 쓰레드는 지정된 객체의 lock을 얻게 되고, 이 블럭을 벗어나면 lock을 반납한다.

```java
syschronized(객체의 참조변수) { // 임계 영역(critical section)
  ...
}
```

- 모든 객체는 lock을 하나씩 가지고 있으며, 해당 객체의 lock을 가지고 있는 쓰레드만 임계 영역의 코드를 수행할 수 있다.
- 그리고 다른 쓰레드들은 lock을 얻을 때까지 기다리게 된다.
